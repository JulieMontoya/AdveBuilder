    1REM..BOBAJOB STREET..
    2REM..Main logic is there, can solve..
    3REM..fixed POUR..
   10MODE7
   20D%=0:E%=0:I%=0:K%=0:L%=0:M%=0:N%=0:R%=0:V%=0
   30Q%=0
   40HIMEM=&3C00
   50*L.M.ABENGIN
   60*L.D.BOBAJOB
   70*L.D.NPCMAP 3C00
   80map=&3C00
   90*K.1HELP|M
  100*K.2INV|M
  110*K.3TAKE|M
  120*K.4BACK|M
  130stream_ptr=&70
  140cmdbuf=&900
  150loc=&5B80
  160gsc=&5B40
  170emo=&5F41
  180prev_rm=&5F4C
  190shift_on=&5C66
  200wrap_on=&5FC1
  210wrap_off=&5FC4
  220get_visited=&5FCD
  230get_state_bit=&5FD0
  240clear_state_bit=&5FD3
  250set_state_bit=&5FD6
  260select_msg=&5FD9
  270select_sysmsg=&5FDC
  280test_avail=&5FDF
  290test_avail_X=&5FE2
  300init_game=&5FE5
  310select_room=&5FE8
  320art_light=&5FEB
  330disp_desc=&5FEE
  340disp_exits=&5FF1
  350list_objects=&5FF4
  360get_cmd=&5FF7
  370action_cmd=&5FFA
  380inventory=&5FFD
 1000CLS
 1010CALLwrap_on
 1020CALLinit_game
 1030ONERRORGOTO2800
 1040REPEAT
 1050E%=0
 1060CALLselect_room
 1070CALLart_light
 1080CALLdisp_desc
 1090IFR%=12ANDFNb(22)=0THENemo?2=0
 1100IFL%<>0AND?&82<>0PRINT"Directions:":CALLdisp_exits
 1110IFR%=16L%=0
 1120CALLlist_objects
 1130IFR%=2ANDloc?18<>2AND?&82<>0PROCm(41)
 1140PROCsk:IFE%=10GOTO2000
 1150?&82=0
 1160IFR%=loc?18PROCcat:IFE%=10GOTO2000
 1170CALLwrap_off:W%=USRget_cmd:CALLwrap_on:CALLshift_on
 1180IFM%=2V%=0
 1190IF?cmdbuf<33THENV%=12:E%=0
 1200IFQ%PRINT"V%=";V%;" M%=";M%;" N%=";N%;" E%=";E%;" NR=";D%;" I%=&";~I%;" L%=";L%
 1210IFV%>0ANDV%<12ANDR%<12PROCexit
 1220IFV%=13PROCexam
 1230IFV%=27PROCins
 1240IFV%=28PROCpour
 1250IFV%=25PROCsearch
 1260IFV%=26PROCfeed
 1270IFV%=28PROCpour
 1280IFV%=29PROCfill
 1290IFV%=30PROCchew
 1300IFV%=31PROCmend
 1310IFV%=32PROCscan
 1320IFV%=33PROCjobs
 1330IFM%=2PROCin
 1340IFV%=34PROChelp
 1350IFV%=35PROCstroke
 1360IFV%=36PROCcall
 1370IFV%=37PROCknock
 1900IF?cmdbuf=81THENE%=10
 2000CALLaction_cmd
 2010IFV%>0ANDV%<12AND(D%=2ORD%=4ORD%=9ORD%=11)ANDFNb(5)=0PROCm(68):R%=emo?11:?&82=0
 2020IFV%>0ANDV%<12AND(D%=2ORD%=4ORD%=9ORD%=11)ANDFNb(5)ANDFNv(D%)=0PROCm(56):PRINT
 2030IFV%=13ANDN%=12ANDE%=0N%=13:PROCexam
 2040IFV%=14ANDN%=8ANDE%=0ANDgsc?1=2PROCm(12):gsc?1=3:PROCcb(12)
 2050IFV%=21ANDM%=35PROCdone(18)
 2060IFV%=21ANDM%=4PROCdone(19)
 2070IFV%=21ANDM%=17PROCdone(20)
 2080IFV%=21ANDM%=25PROCdone(21)
 2090IFloc?25>16AND(R%=9ANDFNv(15)ORR%=15ANDFNv(9))loc?25=6
 2100UNTILE%=10
 2110CALLwrap_off
 2120PRINT'"Do you wish to play again? (Y/n) :";
 2130INPUT""Z$
 2140IF(ASCZ$AND31)<>14GOTO1000
 2150END
 2800CALLwrap_off
 2810REPORT:PRINT" at line ";ERL
 2820END
 3000DEFPROCsearch
 3010E%=7:IFFNa THENE%=9
 3020IFN%=3ANDR%=2 ANDFNb(3)=0PROCsb(3):loc?4=R%:E%=12
 3030IFN%=0AND(R%=2ORR%=4ORR%=9ORR%=11)M%=44:V%=21:GOTO3190
 3040IFN%=15ANDFNa ANDFNb(15)=0PROCsb(15):loc?16=loc?15:loc?17=loc?15:E%=12
 3050IFN%<>14ORFNa=0GOTO3190
 3060FORJ%=1TO?loc:IFloc?J%=16THENE%=12:loc?J%=R%
 3070NEXT
 3190ENDPROC
 3200DEFPROChelp
 3210V%=21:M%=59
 3220IFR%=2ANDloc?18>16M%=60
 3230IFR%=5ANDloc?7>15M%=61
 3240IF(R%=2ANDloc?4>16)OR(R%=15ANDloc?16>16)M%=58
 3250IFR%=9ANDFNb(2)ANDFNb(10)=0M%=14
 3260IF(R%=1ORR%=3ORR%=6ORR%=10)ANDM%=59M%=gsc?2MOD3+64:gsc?2=gsc?2+1
 3270IFFNb(1)=0M%=67
 3280ENDPROC
 3400DEFPROCexam
 3410IFN%=1ANDFNa PRINT"It's a list of your jobs.":V%=0:PROCsb(1):PROCjobs
 3420IFN%=10PROCsb(2)
 3430IFN%=13ANDR%=14ANDgsc?1<3PROCm(2+gsc?1):V%=0:E%=0
 3440IFN%=13ANDR%=14ANDgsc?1>2PROCm(2):V%=0:E%=0
 3450IFN%=21ANDFNa PROCm(gsc?21MOD3+27):V%=0:E%=0:gsc?21=gsc?21+1
 3460IFN%=22ANDR%=13PROCsb(22)
 3470ENDPROC
 3500DEFPROCdone(M%)
 3510IFFNb(1)PROCm(43):PROCm(M%)
 3520ENDPROC
 3600DEFPROCjobs
 3610IFFNb(1)=0PROCm(67):GOTO3690
 3620Z%=0
 3630PRINTFNjob(4);:PROCm(18)
 3640PRINTFNjob(7);:PROCm(19)
 3650PRINTFNjob(10);:PROCm(20)
 3660PRINTFNjob(19);:PROCm(21)
 3670PRINT"You have earned: ";:IFZ%PRINT;Z%;"p."ELSEPRINT"Nothing yet."
 3680IFZ%>15ANDloc?23>16PROCm(53):loc?23=15
 3690ENDPROC
 3800DEFFNjob(A%)
 3810LOCALC$:C$="( ) "
 3820IFFNb(A%)C$="(X) ":Z%=Z%+5
 3830=C$
 3900DEFPROCscan
 3910IFR%<>14THENE%=2
 3920IFR%=14ANDFNa=0THENE%=7
 3930IFR%=14ANDFNa ANDFNb(12)V%=21:M%=7
 3940IFR%=14ANDFNa ANDFNb(12)=0ANDN%<>7PROCm(6):V%=21:M%=5
 3950IFR%=14ANDFNa ANDN%=7ANDFNb(12)=0PROCsb(12):gsc?1=1:PROCm(8):V%=21:M%=3
 3960ENDPROC
 4000DEFPROCins
 4010IFR%=2ANDN%=4V%=26:N%=18:GOTO4090
 4020IFR%=11ANDN%=4V%=26:N%=19:GOTO4090
 4030IFR%<>14THENE%=2
 4040IFR%=14ANDFNa=0THENE%=7
 4050IFR%=14ANDFNb(12)=0THENE%=7:IFFNa V%=21:M%=11
 4060IFR%=14ANDFNb(12)ANDFNa ANDN%<>7V%=21:M%=9
 4070IFR%=14ANDFNb(12)ANDN%=7PROCsb(7):gsc?1=2:loc?7=254:loc?8=14:PROCm(10):V%=21:M%=4
 4090ENDPROC
 4100DEFPROCpour
 4110E%=2
 4120IFR%=2ANDN%=4V%=26:N%=18:E%=0
 4130ENDPROC
 4140DEFPROCmend
 4150IFN%<>10THENE%=7
 4160IFN%=10ANDFNa=0THENE%=2
 4170IFN%=10ANDFNa ANDFNb(10)=0AND(FNb(0)=0ORFNh(8)=0)ANDFNh(16)=0V%=21:M%=14
 4180IFN%=10ANDFNa ANDFNb(10)=0AND(FNb(0)=0ORFNh(8)=0)ANDFNh(16)V%=21:M%=15
 4190IFN%=10ANDFNa ANDFNb(10)=0ANDFNh(8)ANDFNb(8)ANDFNh(16)=0V%=21:M%=16
 4200IFN%=10ANDFNa ANDFNb(10)=0ANDFNh(8)ANDFNb(8)ANDFNh(16)PROCsb(10):loc?8=254:loc?16=254:V%=21:M%=17
 4210ENDPROC
 4220DEFPROCchew
 4230IFN%<>8THENE%=2
 4240IFN%=8ANDFNa=0THENE%=7
 4250IFN%=8ANDFNa PROCsb(8):V%=21:M%=13
 4260ENDPROC
 4300DEFPROCin
 4310IFFNa=0THENE%=7
 4320IFN%<>14THENE%=2
 4330IFN%=14ANDloc?14=0PRINT"Not while you are carrying it!":V%=0:E%=0
 4340IFN%=14ANDloc?14=R%THEN?prev_rm=R%:R%=16:?&82=255:V%=0:E%=0
 4350ENDPROC
 4400DEFPROCfeed
 4410E%=2
 4420IFN%<>19GOTO4470
 4430IFR%<>11THENE%=7:GOTO4510
 4440IFFNh(4)=0ORgsc?4<>6THENE%=13:GOTO4510
 4450IFFNb(19)V%=21:M%=26
 4460IFFNb(19)=0PROCsb(19):gsc?4=5:V%=21:M%=25
 4470IFN%<>18GOTO4510
 4480IFR%<>2THENE%=7:GOTO4510 ELSEIFloc?18<>R%V%=21:M%=41:GOTO4510
 4490IFFNh(4)=0ORgsc?4<>0THENE%=13:GOTO4510
 4500PROCsb(4):gsc?4=5:V%=21:M%=35
 4510ENDPROC
 4600DEFPROCfill
 4610E%=2
 4620IFN%<>4GOTO4670
 4630IFFNa=0THENE%=7:GOTO4670
 4640IFR%<>9V%=21:M%=22
 4650IFR%=9ANDgsc?4<>5V%=21:M%=23
 4660IFR%=9ANDgsc?4=5V%=21:M%=24:gsc?4=6
 4670ENDPROC
 4700DEFPROCexit
 4710IFR%=2ANDD%=1ANDloc?4=0ANDgsc?4=0THENE%=14
 4720IFR%=4ANDD%=3ANDloc?14=0THENE%=14
 4730IFR%=9ANDD%=8
 4740IFR%=11ANDD%=10ANDloc?21=0THENE%=14
 4750ENDPROC
 4800DEFPROCcat
 4810IFFNb(4)GOTO4840
 4820gsc?5=gsc?5+1:IF(gsc?5)MOD2PROCm(30+(gsc?5)DIV2MOD3)ELSEPROCm(33)
 4830GOTO4860
 4840PROCm(36)
 4850gsc?6=gsc?6+1:IFgsc?6>1PROCm(35+gsc?6):IFgsc?6>4THENE%=10
 4860ENDPROC
 4900DEFPROCcall
 4910E%=11
 4920IFR%=2ANDN%=18ANDFNa=0M%=42:V%=21:loc?18=R%
 4930REMPRINTV%,M%,E%
 4940ENDPROC
 5000DEFPROCstroke
 5010E%=2
 5020IFN%=18M%=41:V%=21:IFFNa M%=34
 5030ENDPROC
 5100DEFPROCknock
 5110E%=2
 5120IFR%=1ORR%=3ORR%=6ORR%=8ORR%=10ORR%=13V%=21:M%=55:PROCsb(5)
 5130ENDPROC
 6000DEFPROCsk
 6010LOCALk%,p%,n%,d%:k%=loc?23:IFk%>16GOTO6290
 6020IFR%=16p%=loc?14 ELSEp%=R%
 6030n%=?(map+16*k%+p%):d%=n%DIV16:n%=n%MOD16
 6040IFQ%PRINT"K:";k%;" P:";p%;" N:";n%;" D:";d%;" T:";gsc?23
 6050REMIFd%=3AND?&82GOTO6090
 6060IFd%>0ANDd%<4ANDR%=16PROCm(48)
 6070IFd%=3AND?&82<>0GOTO6090
 6080IFd%>0ANDd%<4ANDR%<16PROCm(44+d%)
 6090loc?23=n%
 6100IFp%=k%gsc?23=gsc?23+1 ELSEgsc?23=0
 6110IF(p%=2ANDk%=1)OR(p%=4ANDk%=3)OR(p%=9ANDk%=8)OR(p%=11ANDk%=10)PROCm(57)
 6120IFgsc?23>0ANDR%<16PROCm(48+gsc?23):IFgsc?23>1 E%=10
 6130IFgsc?23>0ANDR%=16PROCm(50+gsc?23):IFgsc?23>1V%=12:E%=10:Y%=INKEY1000:PRINT:PROCm(62):Y%=INKEY1000:PRINT:PROCm(63):PRINT
 6290ENDPROC
 9990END
10000DEFFNpeek(P%)
10010Q%=!P%AND&FFFF:IFQ%>32767Q%=Q%OR&FFFF0000
10020=Q%
10100DEFPROCpoke(P%,Q%)
10110!P%=!P%AND&FFFF0000ORQ%AND&FFFF
10120ENDPROC
10200DEFFNb(A%)
10210=(USRget_state_bit AND&2000000)=0
10300DEFPROCsb(A%)
10310CALLset_state_bit
10320ENDPROC
10400DEFPROCcb(A%)
10410CALLclear_state_bit
10420ENDPROC
10500DEFPROCm(A%)
10510CALLselect_msg
10520ENDPROC
10600DEFPROCsm(A%)
10610CALLselect_sysmsg
10620ENDPROC
10700DEFFNa
10710=(USRtest_avail AND&2000000)<>0
10800DEFFNh(X%)
10810=(USRtest_avail_X AND&2000000)<>0
10900DEFFNv(A%)
10910=(USRget_visited AND&2000000)=0
